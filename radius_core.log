2025-08-04 19:36:41,594 - main - INFO - Starting Radius Core service...
2025-08-04 19:36:41,594 - redis_client - ERROR - Failed to connect to Redis: Redis URL must specify one of the following schemes (redis://, rediss://, unix://)
2025-08-04 19:36:41,594 - redis_client - ERROR - Redis health check failed: Redis URL must specify one of the following schemes (redis://, rediss://, unix://)
2025-08-04 19:36:41,594 - main - ERROR - Redis health check failed
2025-08-04 19:36:41,594 - aio_pika.robust_connection - INFO - Connection to  closed. Reconnecting after 5 seconds.
2025-08-04 19:36:41,594 - aio_pika.robust_connection - ERROR - Reconnect attempt failed . Retrying after 5 seconds.
Traceback (most recent call last):
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/robust_connection.py", line 135, in __connection_factory
    await Connection.connect(self, self.__connect_timeout)
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/connection.py", line 125, in connect
    self.transport = await UnderlayConnection.connect(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 679, in connect
    connection = await cls.make_connection(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
        url, timeout=timeout, **kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 667, in make_connection
    connection: aiormq.abc.AbstractConnection = await asyncio.wait_for(
                                                ^^^^^^^^^^^^^^^^^^^^^^^
        aiormq.connect(url, **kwargs), timeout=timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 920, in connect
    await connection.connect(client_properties or {})
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/base.py", line 164, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/abc.py", line 44, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 457, in connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2050, in create_connection
ValueError: host and port was not specified and no sock specified
2025-08-04 19:36:46,596 - aio_pika.robust_connection - INFO - Connection to  closed. Reconnecting after 5 seconds.
2025-08-04 19:36:46,596 - aio_pika.robust_connection - ERROR - Reconnect attempt failed . Retrying after 5 seconds.
Traceback (most recent call last):
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/robust_connection.py", line 135, in __connection_factory
    await Connection.connect(self, self.__connect_timeout)
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/connection.py", line 125, in connect
    self.transport = await UnderlayConnection.connect(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 679, in connect
    connection = await cls.make_connection(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
        url, timeout=timeout, **kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 667, in make_connection
    connection: aiormq.abc.AbstractConnection = await asyncio.wait_for(
                                                ^^^^^^^^^^^^^^^^^^^^^^^
        aiormq.connect(url, **kwargs), timeout=timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 920, in connect
    await connection.connect(client_properties or {})
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/base.py", line 164, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/abc.py", line 44, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 457, in connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2050, in create_connection
ValueError: host and port was not specified and no sock specified
2025-08-04 19:36:51,602 - aio_pika.robust_connection - INFO - Connection to  closed. Reconnecting after 5 seconds.
2025-08-04 19:36:51,602 - aio_pika.robust_connection - ERROR - Reconnect attempt failed . Retrying after 5 seconds.
Traceback (most recent call last):
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/robust_connection.py", line 135, in __connection_factory
    await Connection.connect(self, self.__connect_timeout)
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/connection.py", line 125, in connect
    self.transport = await UnderlayConnection.connect(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 679, in connect
    connection = await cls.make_connection(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
        url, timeout=timeout, **kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 667, in make_connection
    connection: aiormq.abc.AbstractConnection = await asyncio.wait_for(
                                                ^^^^^^^^^^^^^^^^^^^^^^^
        aiormq.connect(url, **kwargs), timeout=timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 920, in connect
    await connection.connect(client_properties or {})
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/base.py", line 164, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/abc.py", line 44, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 457, in connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2050, in create_connection
ValueError: host and port was not specified and no sock specified
2025-08-04 19:36:56,605 - aio_pika.robust_connection - INFO - Connection to  closed. Reconnecting after 5 seconds.
2025-08-04 19:36:56,605 - aio_pika.robust_connection - ERROR - Reconnect attempt failed . Retrying after 5 seconds.
Traceback (most recent call last):
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/robust_connection.py", line 135, in __connection_factory
    await Connection.connect(self, self.__connect_timeout)
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/connection.py", line 125, in connect
    self.transport = await UnderlayConnection.connect(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 679, in connect
    connection = await cls.make_connection(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
        url, timeout=timeout, **kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 667, in make_connection
    connection: aiormq.abc.AbstractConnection = await asyncio.wait_for(
                                                ^^^^^^^^^^^^^^^^^^^^^^^
        aiormq.connect(url, **kwargs), timeout=timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 920, in connect
    await connection.connect(client_properties or {})
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/base.py", line 164, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/abc.py", line 44, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 457, in connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2050, in create_connection
ValueError: host and port was not specified and no sock specified
2025-08-04 19:37:01,607 - aio_pika.robust_connection - INFO - Connection to  closed. Reconnecting after 5 seconds.
2025-08-04 19:37:01,607 - aio_pika.robust_connection - ERROR - Reconnect attempt failed . Retrying after 5 seconds.
Traceback (most recent call last):
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/robust_connection.py", line 135, in __connection_factory
    await Connection.connect(self, self.__connect_timeout)
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/connection.py", line 125, in connect
    self.transport = await UnderlayConnection.connect(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 679, in connect
    connection = await cls.make_connection(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
        url, timeout=timeout, **kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aio_pika/abc.py", line 667, in make_connection
    connection: aiormq.abc.AbstractConnection = await asyncio.wait_for(
                                                ^^^^^^^^^^^^^^^^^^^^^^^
        aiormq.connect(url, **kwargs), timeout=timeout,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 920, in connect
    await connection.connect(client_properties or {})
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/base.py", line 164, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/abc.py", line 44, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/home/data/freerad_api/.venv/lib/python3.13/site-packages/aiormq/connection.py", line 457, in connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/root/.local/share/uv/python/cpython-3.13.5-linux-x86_64-gnu/lib/python3.13/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: protocol, host, port, **kwds)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2050, in create_connection
ValueError: host and port was not specified and no sock specified
2025-08-04 19:49:14,390 - main - INFO - Starting Radius Core service...
2025-08-04 19:49:14,418 - redis_client - INFO - Redis connection established successfully
2025-08-04 19:49:14,422 - main - INFO - Redis connection established
2025-08-04 19:49:14,477 - rabbitmq_client - INFO - RabbitMQ connection established successfully
2025-08-04 19:49:14,477 - main - INFO - RabbitMQ connection established
2025-08-04 19:50:05,925 - services - INFO - Попытка авторизации: Packet_Type='string' User_Name='string' Service_Type='string' Acct_Session_Id='string' Framed_Protocol='string' CHAP_Password='string' CHAP_Challenge='string' Calling_Station_Id='string' ERX_Dhcp_Mac_Addr='string' ERX_Dhcp_Options='string' NAS_Identifier='string' NAS_IP_Address='string' NAS_Port='string' NAS_Port_Id='string' NAS_Port_Type='string' Framed_IP_Address='string' Framed_IP_Netmask='string' ERX_Virtual_Router_Name='string' ERX_Pppoe_Description='string' ADSL_Agent_Circuit_Id='string' ADSL_Agent_Remote_Id='string' ERX_DHCP_First_Relay_IPv4_Address='string' Event_Timestamp=datetime.datetime(2025, 8, 4, 14, 50, 4, 73000, tzinfo=TzInfo(UTC)) additionalProp1={}
2025-08-04 19:50:05,926 - crud - WARNING - Could not extract VLAN from NAS-Port-Id: string
2025-08-04 19:50:18,046 - main - INFO - Shutting down Radius Core service...
